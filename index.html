<!DOCTYPE html>
<html lang="en" class="light">
<head>
   <meta charset="UTF-8">
   <meta name="viewport" content="width=device-width, initial-scale=1.0">
   <title>ImageToolkit Pro - Image & PDF Utilities</title>
   <!-- External Library CDNs -->
   <script src="https://cdn.tailwindcss.com"></script>
   <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
   
   <!-- Custom styles -->
   <style>
       /* Custom config for Inter font and animations */
       @import url('https://fonts.googleapis.com/css2?family=Inter:wght@100..900&display=swap');

       :root {
           --primary-color: #6366f1; /* Indigo-500 */
       }

       html {
           font-family: 'Inter', sans-serif;
           transition: background-color 0.3s, color 0.3s;
       }

       /* --- THEME CLASSES --- */
       html.light { background-color: #f4f4f5; color: #18181b; } /* Zinc */
       html.dark { background-color: #18181b; color: #f9fafb; } /* Zinc 900 */
       html.amoled { background-color: #000000; color: #f9fafb; } /* True Black */

       /* Input styling for dark/amoled modes */
       .themed-input {
           transition: background-color 0.3s, border-color 0.3s, color 0.3s;
       }
       .themed-input, .bg-white {
           background-color: #ffffff;
       }
       html.dark .themed-input, html.dark .bg-white {
           background-color: #3f3f46; /* Zinc 700 */
           color: #f9fafb;
       }
       html.amoled .themed-input, html.amoled .bg-white {
           background-color: #18181b; /* Zinc 900 */
           color: #f9fafb;
       }
       .themed-input:focus {
           outline: none;
           box-shadow: 0 0 0 2px var(--primary-color);
       }

       /* Hide the native file input */
       .file-input-hidden {
           width: 0.1px;
           height: 0.1px;
           opacity: 0;
           overflow: hidden;
           position: absolute;
           z-index: -1;
       }
       /* Range slider styling */
       input[type="range"]::-webkit-slider-thumb {
           -webkit-appearance: none;
           appearance: none;
           width: 16px;
           height: 16px;
           border-radius: 50%;
           background: #4f46e5; /* Indigo-600 */
           cursor: pointer;
           box-shadow: 0 0 2px #4f46e5;
       }
       input[type="range"]::-moz-range-thumb {
           width: 16px;
           height: 16px;
           border-radius: 50%;
           background: #4f46e5;
           cursor: pointer;
           box-shadow: 0 0 2px #4f46e5;
       }
   </style>
</head>
<body class="min-h-screen transition-colors duration-300">

   <canvas id="image-canvas" class="hidden"></canvas>

   <div id="app-container" class="max-w-xl mx-auto p-4 md:p-6 pb-20">

       <header class="flex justify-between items-center mb-8 bg-inherit transition-colors duration-300">
           <h1 class="flex items-center text-3xl font-extrabold text-indigo-600 dark:text-indigo-400">
               <svg xmlns="http://www.w3.org/2000/svg" class="w-7 h-7 mr-2 fill-current" viewBox="0 0 24 24">
                   <path d="M21 21v2H3v-2l1-1h16l1 1zm-4.707-8.707a1 1 0 00-1.414 0l-3.586 3.586-3.586-3.586a1 1 0 00-1.414 1.414l4 4a1 1 0 001.414 0l4-4a1 1 0 000-1.414z"/>
                   <path d="M12 4a1 1 0 00-1-1h-2a1 1 0 00-1 1v2a1 1 0 001 1h2a1 1 0 001-1V4zM16 4a1 1 0 00-1-1h-2a1 1 0 00-1 1v2a1 1 0 001 1h2a1 1 0 001-1V4zM8 4a1 1 0 00-1-1H5a1 1 0 00-1 1v2a1 1 0 001 1h2a1 1 0 001-1V4z"/></svg>
               ImageToolkit
           </h1>

           <button
               id="theme-toggle"
               onclick="toggleTheme()"
               class="w-10 h-10 rounded-full flex items-center justify-center shadow-lg transition-all duration-300 transform hover:scale-110 text-xl text-gray-700 dark:text-gray-200 amoled:text-gray-300 bg-gray-200 dark:bg-zinc-800 amoled:bg-gray-900"
               title="Toggle Theme"
           >
               <span id="theme-icon">ðŸ”†</span>
           </button>
       </header>

       <!-- Changed to grid-cols-3 to accommodate the new tab -->
       <div class="grid grid-cols-3 gap-2 p-2 rounded-2xl bg-white dark:bg-zinc-800 amoled:bg-zinc-900 shadow-xl mb-8">
           <button
               id="tab-pdf"
               onclick="setPage('pdf')"
               class="tab-btn p-3 rounded-xl font-semibold text-sm md:text-base transition-all duration-300 transform active:scale-95"
           >
               PDF Converter
           </button>
           <button
               id="tab-compress"
               onclick="setPage('compress')"
               class="tab-btn p-3 rounded-xl font-semibold text-sm md:text-base transition-all duration-300 transform active:scale-95"
           >
               Compressor
           </button>
           <button
               id="tab-history"
               onclick="setPage('history')"
               class="tab-btn p-3 rounded-xl font-semibold text-sm md:text-base transition-all duration-300 transform active:scale-95"
           >
               History
           </button>
       </div>

       <main class="space-y-8">

           <!-- PDF Converter View (Existing) -->
           <section id="pdf-view" class="tool-view">
               <div class="bg-white dark:bg-zinc-800 amoled:bg-zinc-900 p-6 rounded-3xl shadow-2xl transition-all duration-300">
                   <h2 class="text-2xl font-bold mb-4 text-indigo-600 dark:text-indigo-400 flex items-center">
                       <svg class="w-6 h-6 mr-2" fill="currentColor" viewBox="0 0 24 24"><path d="M14 2H6c-1.1 0-2 .9-2 2v16c0 1.1.9 2 2 2h12c1.1 0 2-.9 2-2V8l-6-6zM6 20V4h7v4h4v12H6z"/></svg>
                       Combine Images to PDF
                   </h2>

                   <input type="file" id="pdf-file-input" class="file-input-hidden" accept="image/jpeg, image/png, image/webp" multiple onchange="handleFileSelect(event, 'pdf')">

                   <label for="pdf-file-input" class="w-full h-24 border-4 border-dashed border-indigo-400 dark:border-indigo-600 rounded-xl flex flex-col items-center justify-center cursor-pointer transition-all duration-300 hover:bg-indigo-50 dark:hover:bg-zinc-700/50">
                       <span class="text-lg font-semibold text-indigo-700 dark:text-indigo-300">Tap to Select Multiple Images</span>
                       <span class="text-sm text-gray-500 dark:text-gray-300">JPG, PNG, WEBP accepted.</span>
                   </label>
               </div>

               <div id="pdf-image-list-container" class="hidden bg-white dark:bg-zinc-800 amoled:bg-zinc-900 p-6 rounded-3xl shadow-xl mt-6">
                   <h3 class="text-xl font-bold mb-4">Selected Images:</h3>
                   <div id="pdf-image-list" class="space-y-3">
                       </div>
               </div>

               <div id="pdf-compression-controls" class="hidden mt-6">
                    <div class="grid grid-cols-2 gap-4 mb-4 text-center">
                       <div class="p-3 rounded-xl bg-blue-100 dark:bg-blue-900/50">
                           <p class="text-xs font-medium text-blue-700 dark:text-blue-300">Total Image Size</p>
                           <p id="pdf-original-size" class="text-lg font-bold">--</p>
                       </div>
                       <div class="p-3 rounded-xl bg-green-100 dark:bg-green-900/50">
                           <p class="text-xs font-medium text-green-700 dark:text-green-300">Estimated PDF Size</p>
                           <p id="pdf-estimated-size" class="text-lg font-bold">--</p>
                       </div>
                   </div>

                   <div class="p-4 bg-gray-50 dark:bg-zinc-700/50 rounded-xl">
                       <label for="pdf-quality-slider" class="text-base font-bold flex justify-between mb-2">
                           <span>Image Quality in PDF (Compression)</span>
                           <span id="quality-value-pdf" class="text-indigo-500 font-extrabold">80%</span>
                       </label>
                       <input type="range" id="pdf-quality-slider" min="10" max="100" value="80" step="5"
                           class="w-full h-3 bg-gray-200 rounded-lg appearance-none cursor-pointer range-lg dark:bg-gray-700"
                           oninput="updatePdfCompressionSize();"
                           onchange="updatePdfCompressionSize();">
                   </div>
               </div>

               <div id="pdf-actions" class="hidden grid grid-cols-2 gap-4 mt-6">
                   <button
                       onclick="showNameModal(false)"
                       class="p-4 rounded-xl bg-indigo-600 text-white font-bold shadow-lg hover:bg-indigo-700 transition-all duration-300 active:scale-95"
                   >
                       Standard PDF
                   </button>
                   <button
                       onclick="showNameModal(true)"
                       class="p-4 rounded-xl bg-purple-600 text-white font-bold shadow-lg hover:bg-purple-700 transition-all duration-300 active:scale-95"
                   >
                       Grayscale PDF
                   </button>
               </div>
           </section>

           <!-- Compressor View (Existing) -->
           <section id="compress-view" class="tool-view hidden">
               <div class="bg-white dark:bg-zinc-800 amoled:bg-zinc-900 p-6 rounded-3xl shadow-2xl transition-all duration-300">
                   <h2 class="text-2xl font-bold mb-4 text-indigo-600 dark:text-indigo-400 flex items-center">
                       <svg class="w-6 h-6 mr-2" fill="currentColor" viewBox="0 0 24 24"><path d="M13 12h7v1h-7v-1zm0 4h7v1h-7v-1zm0-8h7v1h-7V8zM4 19h7v1H4v-1zM4 15h7v1H4v-1zM4 11h7v1H4v-1zM4 7h7v1H4V7z"/></svg>
                       Image Compressor
                   </h2>

                   <input type="file" id="compress-file-input" class="file-input-hidden" accept="image/jpeg, image/png, image/webp" onchange="handleFileSelect(event, 'compress')">

                   <label for="compress-file-input" class="w-full h-24 border-4 border-dashed border-indigo-400 dark:border-indigo-600 rounded-xl flex flex-col items-center justify-center cursor-pointer transition-all duration-300 hover:bg-indigo-50 dark:hover:bg-zinc-700/50">
                       <span class="text-lg font-semibold text-indigo-700 dark:text-indigo-300">Select Single Image to Compress</span>
                       <span class="text-sm text-gray-500 dark:text-gray-300">JPG, PNG, WEBP recommended.</span>
                   </label>

                   <div id="compress-controls" class="mt-6 hidden">
                       <div class="grid grid-cols-2 gap-4 mb-4 text-center">
                           <div class="p-3 rounded-xl bg-blue-100 dark:bg-blue-900/50">
                               <p class="text-xs font-medium text-blue-700 dark:text-blue-300">Original Size</p>
                               <p id="original-size" class="text-lg font-bold">--</p>
                           </div>
                           <div class="p-3 rounded-xl bg-green-100 dark:bg-green-900/50">
                               <p class="text-xs font-medium text-green-700 dark:text-green-300">Expected New Size</p>
                               <p id="expected-size" class="text-lg font-bold">--</p>
                           </div>
                       </div>

                       <div class="p-4 bg-gray-50 dark:bg-zinc-700/50 rounded-xl">
                           <label for="compress-quality-slider" class="text-base font-bold flex justify-between mb-2">
                               <span>Compression Quality</span>
                               <span id="quality-value-compress" class="text-indigo-500 font-extrabold">80%</span>
                           </label>
                           <input type="range" id="compress-quality-slider" min="10" max="100" value="80" step="5"
                               class="w-full h-3 bg-gray-200 rounded-lg appearance-none cursor-pointer range-lg dark:bg-gray-700"
                               oninput="updateCompressionSize();"
                               onchange="updateCompressionSize();">
                       </div>

                       <div id="compress-preview-container" class="mt-4 text-center hidden">
                           <h3 class="text-xl font-bold mb-3">Selected Image:</h3>
                           <img id="compress-preview" class="max-w-full h-auto mx-auto rounded-xl shadow-lg border-4 border-gray-200 dark:border-zinc-700 transition-shadow duration-300">
                           <p id="compress-filename" class="mt-2 text-sm text-gray-500 dark:text-gray-300 truncate"></p>
                       </div>

                       <button
                           onclick="processCompression()"
                           class="mt-4 p-4 w-full rounded-xl bg-indigo-600 text-white font-bold shadow-lg hover:bg-indigo-700 transition-all duration-300 active:scale-95"
                       >
                           Download Compressed Image
                       </button>
                   </div>
               </div>
           </section>
           
           <!-- History View (NEW) -->
           <section id="history-view" class="tool-view hidden">
               <div class="bg-white dark:bg-zinc-800 amoled:bg-zinc-900 p-6 rounded-3xl shadow-2xl transition-all duration-300">
                   <h2 class="text-2xl font-bold mb-4 text-indigo-600 dark:text-indigo-400 flex items-center">
                       <svg class="w-6 h-6 mr-2" fill="currentColor" viewBox="0 0 24 24"><path d="M13 3c-4.97 0-9 4.03-9 9H1l3.89 3.89.07.14L9 12h-4c0-4.41 3.59-8 8-8s8 3.59 8 8-3.59 8-8 8c-1.65 0-3.23-.51-4.57-1.48l-.78.78c1.64 1.25 3.73 1.94 6.35 1.94 4.97 0 9-4.03 9-9s-4.03-9-9-9zM12 8v5l4.28 2.54.72-1.21-3.51-2.08V8H12z"/></svg>
                       Last 30 Activities
                   </h2>

                   <div id="history-list" class="space-y-3">
                       <!-- History items will be rendered here -->
                       <p id="history-empty" class="text-center text-gray-500 dark:text-gray-400 py-6 hidden">No activities recorded yet.</p>
                   </div>

                   <button
                       id="clear-history-btn"
                       onclick="clearHistory()"
                       class="mt-6 p-3 w-full rounded-xl bg-red-600 text-white font-bold shadow-lg hover:bg-red-700 transition-all duration-300 active:scale-95 disabled:opacity-50"
                       disabled
                   >
                       Clear History
                   </button>
               </div>
           </section>
       </main>

       <footer class="fixed bottom-0 left-0 right-0 text-center p-3 text-sm text-gray-500 dark:text-gray-300 amoled:text-gray-300 bg-white dark:bg-zinc-800 amoled:bg-black border-t border-gray-200 dark:border-zinc-700 amoled:border-zinc-800 transition-colors duration-300 z-10">
           Â© 2025 Hemanth. All rights reserved
       </footer>
   </div>

   <div id="name-modal" class="fixed inset-0 bg-black bg-opacity-70 backdrop-blur-sm hidden items-center justify-center z-50">
       <div id="modal-content" class="bg-white dark:bg-zinc-700 amoled:bg-zinc-800 p-6 rounded-2xl shadow-3xl max-w-xs w-full transform transition-all duration-300 scale-95 opacity-0">
           <h3 class="text-xl font-bold mb-4 text-indigo-600 dark:text-indigo-400">Save PDF File</h3>
           <p class="mb-4 text-sm text-gray-700 dark:text-gray-300">Enter the desired name for the document.</p>

           <input type="text" id="pdf-filename" placeholder="Document Name"
                   class="w-full p-3 border-2 border-indigo-300 dark:border-indigo-600 rounded-xl mb-4 focus:ring-indigo-500 focus:border-indigo-500 transition duration-150 shadow-inner themed-input"
                   value="ImageToolkit_Export"
           >

           <div id="modal-loading" class="text-center text-sm text-indigo-500 hidden mb-4">
               <div class="flex items-center justify-center space-x-2">
                   <svg class="animate-spin h-5 w-5 text-indigo-500" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24"><circle class="opacity-25" cx="12" cy="12" r="10" stroke="currentColor" stroke-width="4"></circle><path class="opacity-75" fill="currentColor" d="M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"></path></svg>
                   <span>Processing...</span>
               </div>
           </div>

           <div class="flex justify-end space-x-3">
               <button onclick="hideNameModal()" class="px-4 py-2 rounded-xl bg-gray-200 dark:bg-zinc-600 dark:hover:bg-zinc-500 transition active:scale-95 font-medium">Cancel</button>
               <button id="modal-confirm-btn" onclick="confirmDownload()" class="px-4 py-2 rounded-xl bg-indigo-600 text-white hover:bg-indigo-700 transition active:scale-95 font-medium disabled:opacity-50">Download</button>
           </div>
       </div>
   </div>

   <!-- The script tag linking to main.js should be the last element -->
   <script>
       // Use an IIFE or similar structure to prevent polluting the global scope
       (function() {
           // Global variables are defined in main.js scope after load
           const script = document.createElement('script');
           script.src = 'scripts/main.js';
           document.body.appendChild(script);
       })();
   </script>
</body>
</html>